<Page x:Class="PDF_Editor.Pages.AttachmentsPage"
       xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
        xmlns:local="clr-namespace:PDF_Editor"
      xmlns:wpf="clr-namespace:Microsoft.Web.WebView2.Wpf;assembly=Microsoft.Web.WebView2.Wpf"
      Title="Attachments"
      Background="{DynamicResource ApplicationBackgroundBrush}">
    <Grid Margin="16">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="16" />
            <ColumnDefinition Width="1.5*" />
        </Grid.ColumnDefinitions>

        <!-- Left panel: choose PDF if none (and a change button) -->
        <DockPanel Grid.Column="0">
            <!-- Header -->
            <TextBlock Text="Attachments"
               FontSize="28"
               FontWeight="SemiBold"
               Foreground="{DynamicResource TextFillColorPrimaryBrush}"
               DockPanel.Dock="Top"/>

            <!-- Actions + file info -->
            <StackPanel Orientation="Vertical" DockPanel.Dock="Top" Margin="0,8,0,8">
                <ui:Button Content="Select PDF"
                   Click="SelectPdf_Click"
                   Appearance="Primary"
                   CornerRadius="15"
                   Padding="15,8"
                   Cursor="Hand"
                   HorizontalAlignment="Center"
                   Margin="0,10,0,10">
                    <ui:Button.Icon>
                        <ui:SymbolIcon x:Name="OpenIcon" Symbol="FolderOpen24"/>
                    </ui:Button.Icon>
                </ui:Button>

                <TextBlock Text="Current PDF"
                   Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>
                <TextBlock Text="{Binding FileName, TargetNullValue=None, FallbackValue=None}"
                   FontWeight="SemiBold"
                   Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                   Margin="0,0,0,8"/>
                <TextBlock Text="Preview"
                   Margin="0, 0, 0, 8"
                   Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>
                <wpf:WebView2 x:Name="PdfPreview"
                  Width="300"
                  Height="350"
                  HorizontalAlignment="Left"
                  VerticalAlignment="Top"/>
            </StackPanel>

            

        </DockPanel>

        <!-- Right panel: attachments list + add button -->
        <!-- Right panel: actions + scrollable list -->
        <!-- RIGHT PANE -->
        <Grid Grid.Column="2" x:Name="RightPane" HorizontalAlignment="Right">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <!-- actions / header -->
                <RowDefinition Height="*"/>
                <!-- list area fills remaining space -->
            </Grid.RowDefinitions>

            <!-- Actions row -->
            <StackPanel Grid.Row="0"
              Orientation="Horizontal"
              HorizontalAlignment="Right"
              Margin="0,0,0,12">
                <ui:Button Content="Add Attachment"
               Click="AddAttachment_Click"
               Appearance="Primary"/>
            </StackPanel>

            <!-- List area (fills leftover space, no outer ScrollViewer) -->
            <Border Grid.Row="1"
          Background="{DynamicResource ControlBackgroundBrush}"
          BorderBrush="{DynamicResource ControlStrokeColorDefaultBrush}"
          BorderThickness="1"
          CornerRadius="8"
          Padding="8"
          VerticalAlignment="Stretch">
                <ui:ListView x:Name="ListAttachments"
                 ItemsSource="{Binding Attachments}"
                 BorderThickness="0"
                 VerticalAlignment="Stretch"
                 HorizontalAlignment="Stretch"
                 ScrollViewer.VerticalScrollBarVisibility="Auto"
                 ScrollViewer.HorizontalScrollBarVisibility="Auto"
                 VirtualizingPanel.IsVirtualizing="True"
                 VirtualizingPanel.ScrollUnit="Item">
                    <ui:ListView.Resources>
                        <!-- Center headers (optional) -->
                        <Style TargetType="{x:Type GridViewColumnHeader}">
                            <Setter Property="HorizontalContentAlignment" Value="Center"/>
                        </Style>
                        <!-- Make row content stretch so cells use full column width -->
                        <Style TargetType="{x:Type ListViewItem}">
                            <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                            <Setter Property="VerticalContentAlignment" Value="Center"/>
                        </Style>
                    </ui:ListView.Resources>

                    <ui:ListView.View>
                        <ui:GridView>
                            <GridViewColumn Width="220" Header="Name"
                          DisplayMemberBinding="{Binding Name}"/>
                            <GridViewColumn Width="80" Header="Size">
                                <GridViewColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding SizeDisplay}" HorizontalAlignment="Center"/>
                                    </DataTemplate>
                                </GridViewColumn.CellTemplate>
                            </GridViewColumn>
                            <GridViewColumn Width="60" Header="Actions">
                                <GridViewColumn.CellTemplate>
                                    <DataTemplate>
                                        <Grid HorizontalAlignment="Center">
                                            <ui:Button Appearance="Danger"
                             Click="DeleteAttachment_Click"
                             Padding="8,4"
                             Cursor="Hand">
                                                <ui:Button.Icon>
                                                    <ui:SymbolIcon Symbol="Delete24"/>
                                                </ui:Button.Icon>
                                            </ui:Button>
                                        </Grid>
                                    </DataTemplate>
                                </GridViewColumn.CellTemplate>
                            </GridViewColumn>
                        </ui:GridView>
                    </ui:ListView.View>
                </ui:ListView>
            </Border>
        </Grid>

    </Grid>
</Page>
